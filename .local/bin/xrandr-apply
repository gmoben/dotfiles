#!/bin/bash

layout="$HOME/.screenlayout/$1.sh"
if [[ ! -f $layout ]]; then
    echo "ERROR: Layout does not exist ($layout)"
    return 1
fi

CONNECTED=$(xrandr | grep -E " connected " | awk '{print $1}')
DISCONNECTED=$(xrandr | grep -E " disconnected " | awk '{print $1}')

args="$(exec $layout)"
for key in "$DISCONNECTED"; do
    args="$args --output $key ${params[$key]}"
done

echo "Executing: xrandr $args"
xrandr $args

echo "Resetting nitrogen"
$(sleep 1 && [[ -f $HOME/.cache/wal/set_nitrogen.sh ]] && $HOME/.cache/wal/set_nitrogen.sh) &
